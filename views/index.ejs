<!DOCTYPE html>
<html lang="id">
<head>
    <%- include('partials/header') %>
</head>
<body>
    <!-- Loading Spinner -->
    <div id="loader-wrapper">
        <div id="loader"></div>
    </div>
    <!-- Scroll Progress Bar -->
    <div id="scroll-progress-container">
        <div id="scroll-progress-bar"></div>
    </div>

<%- include('partials/navbar') %>

<section class="background-section">
    <!-- Hero Section with Search -->
    <section class="bg-light hero-section">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-6">
                    <h1 class="display-4 fw-bold mb-4c" data-aos="fade-up" data-aos-delay="100">Temukan Karir <span style="color: var(--primary-color);">Impianmu</span></h1>
                    <p class="lead mb-4" data-aos="fade-up" data-aos-delay="200">Akses banyak lowongan pekerjaan pilihan bersama 
                        <span style="color: var(--primary-color); font-weight: bold;">PT Herba Emas Wahidatama.</span> Langkah awal menuju karir terbaikmu dimulai.</p>
                    <div class="search-box mb-5" data-aos="fade-up" data-aos-delay="200">
                        <form id="searchForm">
                            <div class="row g-2">
                                <div class="col-md-10">
                                    <div class="input-group">
                                        <span class="input-group-text bg-white border-end-0">
                                            <i class="fas fa-search"></i>
                                        </span>
                                        <input type="text" class="form-control border-start-0" id="keyword" placeholder="Posisi atau kata kunci lain">
                                        <button type="button" class="input-group-text bg-white border-start-0 d-none" id="clearKeyword">
                                            <i class="fas fa-times text-muted"></i>
                                        </button>
                                    </div>
                                </div>
                                <div class="col-md-2">
                                    <button type="submit" class="btn btn-primary-custom w-100" id="btnSearch">Cari</button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
                <div class="col-lg-6" data-aos="fade-left" data-aos-delay="200">
                    <img src="/assets/img/job-search.jpg" alt="Job Search Illustration" class="img-fluid">
                </div>
            </div>
            <!-- Hasil pencarian ditampilkan di sini -->
            <div id="searchResults" class="mt-4"></div>
        </div>
        <script src="assets/search.js"></script>  
    </section>

    <!-- Featured Companies -->
    <section class="py-5 bg-white">
        <div class="container">
            <p class="text-center text-muted mb-4" data-aos="fade-up" data-aos-delay="100">DIPERCAYA OLEH PERUSAHAAN TERKEMUKA</p>
            <div class="row featured-companies justify-content-center align-items-center" data-aos="zoom-in" data-aos-delay="200">
                <div class="col-4 col-md-2 text-center mb-4">
                    <img src="/assets/img/logo/HNI.png" class="img-fluid">
                </div>
                <div class="col-4 col-md-2 text-center mb-4">
                    <img src="/assets/img/logo/EMC.png" class="img-fluid">
                </div>
                <div class="col-4 col-md-2 text-center mb-4">
                    <img src="/assets/img/logo/HEW.png" class="img-fluid">
                </div>
                <div class="col-4 col-md-2 text-center mb-4">
                    <img src="/assets/img/logo/HerbaTech.jpg" class="img-fluid">
                </div>
                <div class="col-4 col-md-2 text-center mb-4">
                    <img src="/assets/img/logo/Farmakos.png" class="img-fluid">
                </div>
                <div class="col-4 col-md-2 text-center mb-4">
                    <img src="/assets/img/logo/AEJ.png" class="img-fluid">
                </div>
                <div class="col-4 col-md-2 text-center mb-4">
                    <img src="/assets/img/logo/CADistri.png" class="img-fluid">
                </div>
                <div class="col-4 col-md-2 text-center mb-4">
                    <img src="/assets/img/logo/Kulakin.png" class="img-fluid">
                </div>
                <div class="col-4 col-md-2 text-center mb-4">
                    <img src="/assets/img/logo/Erdigma.png" class="img-fluid">
                </div>
                <div class="col-4 col-md-2 text-center mb-4">
                    <img src="/assets/img/logo/LJT.png" class="img-fluid">
                </div>
                <div class="col-4 col-md-2 text-center mb-4">
                    <img src="/assets/img/logo/EDX2.png" class="img-fluid">
                </div>
                <div class="col-4 col-md-2 text-center mb-4">
                    <img src="/assets/img/logo/EI.png" class="img-fluid">
                </div>
                <div class="col-4 col-md-2 text-center mb-4">
                    <img src="/assets/img/logo/EJG.png" class="img-fluid">
                </div>
                <div class="col-4 col-md-2 text-center mb-4">
                    <img src="/assets/img/logo/SPI.png" class="img-fluid">
                </div>
            </div>
        </div>
    </section>

    <!-- Job Categories -->
    <section class="py-5">
        <div class="container">
            <h2 class="section-title" data-aos="fade-up" data-aos-delay="100">Jelajahi Berdasarkan Kategori</h2>
            <div class="row g-4 justify-content-center" id="jobCategories" data-aos="fade-up" data-aos-delay="200">
                <!-- 4 Kategori Pertama -->
                <div class="col-6 col-md-3">
                    <div class="category-card">
                        <div class="icon-box mb-3">
                            <i class="fas fa-laptop-code fa-2x" style="color: var(--primary-color);"></i>
                        </div>
                        <h5>Technology</h5>
                    </div>
                </div>
                <div class="col-6 col-md-3">
                    <div class="category-card">
                        <div class="icon-box mb-3">
                            <i class="fas fa-user fa-2x" style="color:rebeccapurple"></i>
                        </div>
                        <h5>Human Experience</h5>
                    </div>
                </div>
                <div class="col-6 col-md-3">
                    <div class="category-card">
                        <div class="icon-box mb-3">
                            <i class="fas fa-building fa-2x" style="color:blue"></i>
                        </div>
                        <h5>General Affair</h5>
                    </div>
                </div>
                <div class="col-6 col-md-3">
                    <div class="category-card">
                        <div class="icon-box mb-3">
                            <i class="fas fa-calculator fa-2x" style="color:blueviolet"></i>
                        </div>
                        <h5>Finance Accounting</h5>
                    </div>
                </div>
            </div>
            <!-- Kategori Lainnya -->
            <div id="moreCategories" class="d-none" data-aos="fade-up" data-aos-delay="200">
                <div class="row g-4 justify-content-center">
                    <div class="col-6 col-md-3">
                        <div class="category-card">
                            <div class="icon-box mb-3">
                                <i class="fas fa-flask fa-2x" style="color:brown"></i>
                            </div>
                            <h5>Research Development</h5>
                        </div>
                    </div>
                    <div class="col-6 col-md-3">
                        <div class="category-card">
                            <div class="icon-box mb-3">
                                <i class="fas fa-truck-moving fa-2x" style="color:chartreuse"></i>
                            </div>
                            <h5>Supply Chain</h5>
                        </div>
                    </div>
                    <div class="col-6 col-md-3">
                        <div class="category-card">
                            <div class="icon-box mb-3">
                                <i class="fas fa-industry fa-2x" style="color:crimson"></i>
                            </div>
                            <h5>Production</h5>
                        </div>
                    </div>
                    <div class="col-6 col-md-3">
                        <div class="category-card">
                            <div class="icon-box mb-3">
                                <i class="fas fa-cogs fa-2x" style="color:gold"></i>
                            </div>
                            <h5>Engineering</h5>
                        </div>
                    </div>
                    <div class="col-6 col-md-3">
                        <div class="category-card">
                            <div class="icon-box mb-3">
                                <i class="fas fa-search fa-2x" style="color:slateblue"></i>
                            </div>
                            <h5>Quality Control</h5>
                        </div>
                    </div>
                </div>
            </div>
            <div class="text-center mt-4" data-aos="zoom-in" data-aos-delay="200">
                <button class="btn btn-outline-custom" id="showMoreBtn">
                    <i class="fas fa-chevron-down me-2"></i>Lihat Semua Kategori
                </button>
            </div>
        </div>
        <script>
            // Lihat Kategori
            const btn = document.getElementById('showMoreBtn');
            const more = document.getElementById('moreCategories');

            btn.addEventListener('click', function () {
                if (more.classList.contains('d-none')) {
                more.classList.remove('d-none');
                btn.innerHTML = '<i class="fas fa-chevron-up me-2"></i>Sembunyikan Kategori';
                AOS.refresh(); // ← penting: beri tahu AOS untuk update posisi elemen
                } else {
                more.classList.add('d-none');
                btn.innerHTML = '<i class="fas fa-chevron-down me-2"></i>Lihat Semua Kategori';
                }
            });
        </script>
    </section>

    <!-- Featured Jobs -->
    <section class="py-5 bg-light">
        <div class="container">
            <div class="d-flex justify-content-between align-items-center mb-4" data-aos="fade-up" data-aos-delay="100">
                <h2 class="section-title mb-0">Lowongan Terbaru</h2>
                <!-- <div class="d-none d-md-block">
                    <a href="#" class="btn btn-outline-custom">Lihat Semua</a>
                </div> -->
            </div>
            <div id="listLoker"></div>
            
            <!-- <div class="d-md-none text-center mt-3 d-block">
                <a href="#" class="btn btn-outline-custom">Lihat Semua</a>
            </div> -->
        </div>
    </section>

    <!-- How It Works -->
    <section class="py-5">
        <div class="container">
            <h2 class="section-title" data-aos="fade-up" data-aos-delay="100">Bagaimana Cara Kerjanya</h2>
            <div class="row mt-5">
                <div class="col-md-4 text-center mb-4 mb-md-0" data-aos="fade-up" data-aos-delay="200">
                    <div class="px-4">
                        <div class="bg-light rounded-circle d-flex align-items-center justify-content-center mx-auto mb-4" style="width: 100px; height: 100px;">
                            <i class="fas fa-user-plus fa-2x" style="color: var(--primary-color);"></i>
                        </div>
                        <h4>1. Buat Profil</h4>
                        <p class="text-muted">Daftar dan lengkapi profil dengan pengalaman dan keterampilan karirmu.</p>
                    </div>
                </div>
                <div class="col-md-4 text-center mb-4 mb-md-0" data-aos="fade-up" data-aos-delay="200">
                    <div class="px-4">
                        <div class="bg-light rounded-circle d-flex align-items-center justify-content-center mx-auto mb-4" style="width: 100px; height: 100px;">
                            <i class="fas fa-search fa-2x" style="color: var(--primary-color);"></i>
                        </div>
                        <h4>2. Temukan Pekerjaan</h4>
                        <p class="text-muted">Cari pekerjaan yang sesuai dengan minatmu.</p>
                    </div>
                </div>
                <div class="col-md-4 text-center" data-aos="fade-up" data-aos-delay="200">
                    <div class="px-4">
                        <div class="bg-light rounded-circle d-flex align-items-center justify-content-center mx-auto mb-4" style="width: 100px; height: 100px;">
                            <i class="fas fa-paper-plane fa-2x" style="color: var(--primary-color);"></i>
                        </div>
                        <h4>3. Lamar & Terhubung</h4>
                        <p class="text-muted">Lamar dengan mudah dan dapatkan tawaran pekerjaan terbaik.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- CTA Section -->
    <section class="py-5" style="background-color: var(--primary-color); overflow-x: hidden;">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-8 text-white" data-aos="fade-left" data-aos-delay="100">
                    <h2 class="mb-3">Siap untuk memulai karir barumu?</h2>
                    <p class="lead mb-0">Gabung sekarang dan temukan peluang kerja terbaik yang sesuai dengan minat dan keahlianmu.</p>
                </div>
                <div class="col-md-4 text-center text-md-end mt-4 mt-md-0" data-aos="fade-right" data-aos-delay="200">
                    <a href="/signup" class="btn btn-light px-4 py-2 w-100 w-md-auto">Daftar Sekarang</a>
                </div>
            </div>
        </div>
    </section>

</section>

<!-- Tombol Back to Top -->
<button id="backToTop" title="Kembali ke atas">
    <i class="fas fa-chevron-up"></i>
</button>

<%- include('partials/footer') %>
    <script>
        var html = `<div class="row" data-aos="zoom-in" data-aos-delay="200">`
        $(document).ready(function(){
            const res = $.parseJSON(
                $.ajax({
                url: 'https://herbaemas.com/data-lowongan-limit',
                method: 'get',
                dataType: 'json',
                async: false
              }).responseText
            )
            const data = res.data
            for (let i = 0; i < data.length; i++) {
                const tanggalAwal = new Date(data[i].createdAt);
                const hariIni = new Date(); // otomatis ambil tanggal hari ini

                // Hitung selisih dalam milidetik
                const selisihMs = hariIni - tanggalAwal;

                // Ubah ke hari
                const selisihHari = Math.floor(selisihMs / (1000 * 60 * 60 * 24));
                html += `
                    <!-- Job Card 1 -->
                    <div class="col-md-6 col-lg-4 mb-4">
                        <a href="#" onclick="detailLoker(${ data[i].id })" class="text-decoration-none text-dark">
                            <div class="job-card bg-white h-100 position-relative p-3 border rounded" data-bs-toggle="modal" data-bs-target="#jobDetailModal">
                                <div class="d-flex justify-content-between mb-3">
                                    <img src="/assets/img/logo/HEW.png" alt="Company Logo" class="company-logo">
                                    <!-- <button class="btn btn-sm btn-outline-secondary rounded-circle">
                                        <i class="far fa-bookmark"></i>
                                    </button> -->
                                </div>
                                <h5 class="job-title mb-1">${ data[i].position }</h5>
                                <p class="company-name text-muted mb-2">PT Herba Emas Wahidatama</p>
                                <p class="location mb-3"><i class="fas fa-map-marker-alt me-1"></i> Purbalingga</p>
                                <div class="mb-3">
                                    <span class="badge-custom">Full-time</span>
                                </div>
                                <div class="d-flex justify-content-between align-items-center">
                                    <p class="salary fw-bold mb-0">${ data[i].salary }</p>
                                    <p class="posted text-muted small mb-0">${selisihHari} hari yang lalu</p>
                                </div>
                                <!-- Tombol Detail -->
                                <!-- <button type="button" class="btn btn-outline-custom btn-sm position-absolute top-0 end-0 m-2">
                                    <i class="fa fa-info-circle me-1"></i> Detail
                                </button>   -->
                            </div>
                        </a>
                    </div>
                `            
            }
            html += '</div>'
            $('#listLoker').html(html)
        });
        function detailLoker(id){
            localStorage.setItem('idloker', id);
            window.location= "/detail-loker";
        }
    </script>
</body>
</html>