<!DOCTYPE html>
<html lang="id">
<head>
    <%- include('partials/header') %>
</head>
<body>
    <!-- Loading Spinner -->
    <div id="loader-wrapper">
        <div id="loader"></div>
    </div>
    <!-- Scroll Progress Bar -->
    <div id="scroll-progress-container">
        <div id="scroll-progress-bar"></div>
    </div>

<%- include('partials/navbar') %>

<section class="background-section">
    <!-- Hero Section with Search -->
    <section class="hero-section">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-6">
                    <h1 class="display-4 fw-bold mb-4c" data-aos="fade-up" data-aos-delay="100">Temukan Karir <span style="color: var(--primary-color);">Impianmu</span></h1>
                    <p class="lead mb-4" data-aos="fade-up" data-aos-delay="200">Akses banyak lowongan pekerjaan pilihan bersama 
                        <span style="color: var(--primary-color); font-weight: bold;">PT Herba Emas Wahidatama.</span> Langkah awal menuju karir terbaikmu dimulai.
                    </p>
                </div>
                <div class="col-lg-6" data-aos="fade-left" data-aos-delay="200">
                    <img src="/assets/img/job-search.jpg" alt="Job Search Illustration" class="img-fluid">
                </div>
            </div>
        </div>
    </section>

    <!-- Our Galleries -->
    <section class="py-5 bg-white">
        <div class="container">
            <p class="text-center text-muted mb-4" data-aos="fade-up" data-aos-delay="100">TENTANG PT HERBA EMAS WAHIDATAMA</p>
            <div class="gallery-slider" data-aos="fade-up" data-aos-delay="200">
                <div><img src="/assets/img/galeri1.jpg" class="img-fluid rounded shadow-sm" alt="Galeri 1"></div>
                <div><img src="/assets/img/galeri2.jpg" class="img-fluid rounded shadow-sm" alt="Galeri 2"></div>
                <div><img src="/assets/img/galeri3.jpg" class="img-fluid rounded shadow-sm" alt="Galeri 3"></div>
                <div><img src="/assets/img/galeri4.jpg" class="img-fluid rounded shadow-sm" alt="Galeri 4"></div>
                <div><img src="/assets/img/galeri5.jpg" class="img-fluid rounded shadow-sm" alt="Galeri 5"></div>
                <div><img src="/assets/img/galeri6.jpg" class="img-fluid rounded shadow-sm" alt="Galeri 6"></div>
                <div><img src="/assets/img/galeri7.jpg" class="img-fluid rounded shadow-sm" alt="Galeri 7"></div>
                <div><img src="/assets/img/galeri8.jpg" class="img-fluid rounded shadow-sm" alt="Galeri 8"></div>
            </div>
        </div>
    </section>

    <!-- Job Categories -->
    <section class="py-5">
        <div class="container">
            <h2 class="section-title" data-aos="fade-up" data-aos-delay="100">Jelajahi Berdasarkan Kategori</h2>
            <div class="row g-4 justify-content-center" id="jobCategories" data-aos="fade-up" data-aos-delay="200">
                <!-- 4 Kategori Pertama -->
                <div class="col-6 col-md-3">
                    <div class="category-card">
                        <div class="icon-box mb-3">
                            <i class="fas fa-laptop-code fa-2x" style="color: var(--primary-color);"></i>
                        </div>
                        <h5>Technology</h5>
                    </div>
                </div>
                <div class="col-6 col-md-3">
                    <div class="category-card">
                        <div class="icon-box mb-3">
                            <i class="fas fa-user fa-2x" style="color:rebeccapurple"></i>
                        </div>
                        <h5>Human Experience</h5>
                    </div>
                </div>
                <div class="col-6 col-md-3">
                    <div class="category-card">
                        <div class="icon-box mb-3">
                            <i class="fas fa-building fa-2x" style="color:blue"></i>
                        </div>
                        <h5>General Affair</h5>
                    </div>
                </div>
                <div class="col-6 col-md-3">
                    <div class="category-card">
                        <div class="icon-box mb-3">
                            <i class="fas fa-calculator fa-2x" style="color:blueviolet"></i>
                        </div>
                        <h5>Finance Accounting</h5>
                    </div>
                </div>
            </div>
            <!-- Kategori Lainnya -->
            <div id="moreCategories" class="d-none" data-aos="fade-up" data-aos-delay="200">
                <div class="row g-4 justify-content-center">
                    <div class="col-6 col-md-3">
                        <div class="category-card">
                            <div class="icon-box mb-3">
                                <i class="fas fa-flask fa-2x" style="color:brown"></i>
                            </div>
                            <h5>Research Development</h5>
                        </div>
                    </div>
                    <div class="col-6 col-md-3">
                        <div class="category-card">
                            <div class="icon-box mb-3">
                                <i class="fas fa-truck-moving fa-2x" style="color:chartreuse"></i>
                            </div>
                            <h5>Supply Chain</h5>
                        </div>
                    </div>
                    <div class="col-6 col-md-3">
                        <div class="category-card">
                            <div class="icon-box mb-3">
                                <i class="fas fa-industry fa-2x" style="color:crimson"></i>
                            </div>
                            <h5>Production</h5>
                        </div>
                    </div>
                    <div class="col-6 col-md-3">
                        <div class="category-card">
                            <div class="icon-box mb-3">
                                <i class="fas fa-cogs fa-2x" style="color:gold"></i>
                            </div>
                            <h5>Engineering</h5>
                        </div>
                    </div>
                    <div class="col-6 col-md-3">
                        <div class="category-card">
                            <div class="icon-box mb-3">
                                <i class="fas fa-search fa-2x" style="color:slateblue"></i>
                            </div>
                            <h5>Quality Control</h5>
                        </div>
                    </div>
                </div>
            </div>
            <div class="text-center mt-4" data-aos="zoom-in" data-aos-delay="200">
                <button class="btn btn-outline-custom" id="showMoreBtn">
                    <i class="fas fa-chevron-down me-2"></i>Lihat Semua Kategori
                </button>
            </div>
        </div>
        <script>
            // Lihat Kategori
            const btn = document.getElementById('showMoreBtn');
            const more = document.getElementById('moreCategories');

            btn.addEventListener('click', function () {
                if (more.classList.contains('d-none')) {
                more.classList.remove('d-none');
                btn.innerHTML = '<i class="fas fa-chevron-up me-2"></i>Sembunyikan Kategori';
                AOS.refresh(); // ‚Üê penting: beri tahu AOS untuk update posisi elemen
                } else {
                more.classList.add('d-none');
                btn.innerHTML = '<i class="fas fa-chevron-down me-2"></i>Lihat Semua Kategori';
                }
            });
        </script>
    </section>

    <!-- Featured Jobs -->
    <section class="py-5 bg-light">
        <div class="container">
            <div class="row align-items-center mb-4" data-aos="fade-up" data-aos-delay="100">
                <div class="col-md-6">
                    <h2 class="section-title mb-0 mb-md-0 mb-2">Lowongan Terbaru</h2>
                </div>
                <div class="col-md-6 mt-3 mt-md-0">
                    <form id="searchForm">
                        <div class="input-group">
                            <span class="input-group-text bg-white border-end-0">
                                <i class="fas fa-search"></i>
                            </span>
                            <input type="text" class="form-control border-start-0" id="keyword" placeholder="Cari Posisi">
                            <button type="button" class="btn btn-outline-secondary d-none" id="clearKeyword">
                                <i class="fas fa-times"></i>
                            </button>
                            <button type="submit" class="btn btn-primary-custom" id="btnSearch">
                                <span class="spinner-border spinner-border-sm me-2 d-none" role="status" id="searchSpinner"></span>
                                <span id="btnSearchText">Cari</span>
                            </button>
                        </div>
                    </form>
                </div>
            </div>
            <div id="listLoker"></div>
            
            <!-- <div class="d-md-none text-center mt-3 d-block">
                <a href="#" class="btn btn-outline-custom">Lihat Semua</a>
            </div> -->
        </div>
    </section>

    <!-- How It Works -->
    <section class="py-5">
        <div class="container">
            <h2 class="section-title" data-aos="fade-up" data-aos-delay="100">Bagaimana Cara Kerjanya</h2>
            <div class="row mt-5">
                <div class="col-md-4 text-center mb-4 mb-md-0" data-aos="fade-up" data-aos-delay="200">
                    <div class="px-4">
                        <div class="bg-light rounded-circle d-flex align-items-center justify-content-center mx-auto mb-4" style="width: 100px; height: 100px;">
                            <i class="fas fa-user-plus fa-2x" style="color: var(--primary-color);"></i>
                        </div>
                        <h4>1. Buat Profil</h4>
                        <p class="text-muted">Daftar dan lengkapi profil dengan pengalaman dan keterampilan karirmu.</p>
                    </div>
                </div>
                <div class="col-md-4 text-center mb-4 mb-md-0" data-aos="fade-up" data-aos-delay="200">
                    <div class="px-4">
                        <div class="bg-light rounded-circle d-flex align-items-center justify-content-center mx-auto mb-4" style="width: 100px; height: 100px;">
                            <i class="fas fa-search fa-2x" style="color: var(--primary-color);"></i>
                        </div>
                        <h4>2. Temukan Pekerjaan</h4>
                        <p class="text-muted">Cari pekerjaan yang sesuai dengan minatmu.</p>
                    </div>
                </div>
                <div class="col-md-4 text-center" data-aos="fade-up" data-aos-delay="200">
                    <div class="px-4">
                        <div class="bg-light rounded-circle d-flex align-items-center justify-content-center mx-auto mb-4" style="width: 100px; height: 100px;">
                            <i class="fas fa-paper-plane fa-2x" style="color: var(--primary-color);"></i>
                        </div>
                        <h4>3. Lamar & Terhubung</h4>
                        <p class="text-muted">Lamar dengan mudah dan dapatkan tawaran pekerjaan terbaik.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- CTA Section -->
    <section class="py-5" style="background-color: var(--primary-color); overflow-x: hidden;">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-8 text-white" data-aos="fade-left" data-aos-delay="100">
                    <h2 class="mb-3">Siap untuk memulai karir barumu?</h2>
                    <p class="lead mb-0">Gabung sekarang dan temukan peluang kerja terbaik yang sesuai dengan minat dan keahlianmu.</p>
                </div>
                <div class="col-md-4 text-center text-md-end mt-4 mt-md-0" data-aos="fade-right" data-aos-delay="200">
                    <a href="/signup" class="btn btn-light px-4 py-2 w-100 w-md-auto">Daftar Sekarang</a>
                </div>
            </div>
        </div>
    </section>

</section>

<!-- Tombol Back to Top -->
<button id="backToTop" title="Kembali ke atas">
    <i class="fas fa-chevron-up"></i>
</button>

<%- include('partials/footer') %>

<!-- <script>
    var html = `<div class="row" data-aos="zoom-in" data-aos-delay="200">`
    $(document).ready(function(){
        const res = $.parseJSON(
            $.ajax({
            url: 'https://herbaemas.com/data-lowongan-limit',
            method: 'get',
            dataType: 'json',
            async: false
            }).responseText
        )
        const data = res.data
        for (let i = 0; i < data.length; i++) {
            const tanggalAwal = new Date(data[i].createdAt);
            const hariIni = new Date(); // otomatis ambil tanggal hari ini

            // Hitung selisih dalam milidetik
            const selisihMs = hariIni - tanggalAwal;

            // Ubah ke hari
            const selisihHari = Math.floor(selisihMs / (1000 * 60 * 60 * 24));
            html += `
            <div class="col-md-6 col-lg-4 mb-4">
                <a href="javascript:void(0)" onclick="detailLoker(${ data[i].id })" class="text-decoration-none text-dark">
                    <div class="job-card bg-white h-100 position-relative p-3 border rounded" data-bs-toggle="modal" data-bs-target="#jobDetailModal">
                        <div class="d-flex justify-content-between mb-3">
                            <img src="/assets/img/logo/HEW.png" alt="Company Logo" class="company-logo">
                        </div>
                        <h5 class="job-title mb-1">${ data[i].position }</h5>
                        <p class="company-name text-muted mb-2">PT Herba Emas Wahidatama</p>
                        <p class="location mb-3"><i class="fas fa-map-marker-alt me-1"></i> Purbalingga</p>
                        <div class="mb-3">
                            <span class="badge-custom">Full-time</span>
                        </div>
                        <div class="d-flex justify-content-between align-items-center">
                            <p class="salary fw-bold mb-0">${ data[i].salary }</p>
                            <p class="posted text-muted small mb-0">${selisihHari} hari yang lalu</p>
                        </div>
                    </div>
                </a>
            </div>
            `            
        }
        html += '</div>'
        $('#listLoker').html(html)
    });
    function detailLoker(id){
        localStorage.setItem('idloker', id);
        window.location= "/detail-loker";
    }
</script> -->

<script>
    var html = "";

    $(document).ready(function () {
        const keywordInput = $('#keyword');
        const clearBtn = $('#clearKeyword');

        const fetchAndRender = (keyword = "") => {
            $.ajax({
                url: 'https://herbaemas.com/data-lowongan-limit',
                method: 'GET',
                dataType: 'json',
                success: function (res) {
                    const data = res.data;
                    let filtered = data;

                    if (keyword) {
                        const lowerKeyword = keyword.toLowerCase();
                        filtered = data.filter(item =>
                            item.position.toLowerCase().includes(lowerKeyword)
                        );
                    }

                    if (filtered.length === 0) {
                        $('#listLoker').html(`<p class="text-muted">Tidak ada hasil untuk posisi "<strong>${keyword}</strong>".</p>`);
                        return;
                    }

                    html = `<div class="row" data-aos="zoom-in" data-aos-delay="200">`;

                    for (let i = 0; i < filtered.length; i++) {
                        const tanggalAwal = new Date(filtered[i].createdAt);
                        const hariIni = new Date();
                        const selisihMs = hariIni - tanggalAwal;
                        const selisihHari = Math.floor(selisihMs / (1000 * 60 * 60 * 24));

                        html += `
                            <div class="col-md-6 col-lg-4 mb-4">
                                <a href="javascript:void(0)" onclick="detailLoker(${filtered[i].id})" class="text-decoration-none text-dark">
                                    <div class="job-card bg-white h-100 position-relative p-3 border rounded">
                                        <div class="d-flex justify-content-between mb-3">
                                            <img src="/assets/img/logo/HEW.png" alt="Company Logo" class="company-logo">
                                        </div>
                                        <h5 class="job-title mb-1">${filtered[i].position}</h5>
                                        <p class="company-name text-muted mb-2">PT Herba Emas Wahidatama</p>
                                        <p class="location mb-3"><i class="fas fa-map-marker-alt me-1"></i> Purbalingga</p>
                                        <div class="mb-3">
                                            <span class="badge-custom">Full-time</span>
                                        </div>
                                        <div class="d-flex justify-content-between align-items-center">
                                            <p class="salary fw-bold mb-0">${filtered[i].salary}</p>
                                            <p class="posted text-muted small mb-0">${selisihHari} hari yang lalu</p>
                                        </div>
                                    </div>
                                </a>
                            </div>
                        `;
                    }

                    html += '</div>';
                    $('#listLoker').html(html);
                    AOS.refresh();
                    $('#searchSpinner').addClass('d-none');
                    $('#btnSearchText').text('Cari');
                },
                error: function () {
                    $('#listLoker').html("<p class='text-danger'>Gagal memuat data lowongan.</p>");
                    $('#searchSpinner').addClass('d-none');
                    $('#btnSearchText').text('Cari');
                }
            });
        };

        // Awal saat halaman dimuat
        fetchAndRender();

        // Tampilkan tombol silang saat input terisi
        keywordInput.on('input', function () {
            clearBtn.toggleClass('d-none', $(this).val().trim().length === 0);
        });

        // Tombol submit pencarian
        $('#searchForm').on('submit', function (e) {
            e.preventDefault();
            const keyword = keywordInput.val().trim();

            // Tampilkan spinner
            $('#searchSpinner').removeClass('d-none');
            $('#btnSearchText').text('');

            // Lakukan pencarian
            fetchAndRender(keyword);
        });


        // Tombol clear (ikon silang)
        clearBtn.on('click', function () {
            keywordInput.val('');
            clearBtn.addClass('d-none');
            fetchAndRender(); // tampilkan semua lowongan kembali
        });
    });

    // Detail Loker
    function detailLoker(id) {
        localStorage.setItem('idloker', id);
        window.location = "/detail-loker";
    }

    // Image Slider
    $(document).ready(function(){
        $('.gallery-slider').slick({
        slidesToShow: 2,
        slidesToScroll: 1,
        dots: true,
        autoplay: true,
        autoplaySpeed: 3000,
        arrows: false,
        responsive: [
            {
            breakpoint: 768,
            settings: {
                slidesToShow: 1
            }
            }
        ]
        });
    });
</script>

</body>
</html>